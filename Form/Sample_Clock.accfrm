Version =20
VersionRequired =20
Checksum =544716651
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ShortcutMenu = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =204
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =2499
    DatasheetFontHeight =10
    ItemSuffix =236
    Left =2910
    Top =1065
    Right =5415
    Bottom =4695
    TimerInterval =500
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x4fac3f72d483e240
    End
    GUID = Begin
        0x82ff31c81a34ae48a1bbb02bf0476f51
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000003000000 ,
        0x0000000000000000000000000000
    End
    Caption ="Часы"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial Cyr"
    PrtMip = Begin
        0xa9050000a4050000a4050000a405000000000000f1110000051b000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c002c1e43ff8007010009009a0b3408640001000f00580202000100 ,
        0x5802020000004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000001d010000ffffffff0000000000000000000000000000000044494e55 ,
        0x22000808440ae81389b293040000000000000000000000000000000000000000 ,
        0x0000000000000000440000000000000000000000000000000800000002000200 ,
        0x02000200020002000200020002000200020000000000000000000d0000000000 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000010000000000000000000000000000000000 ,
        0x0000000000000000070000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000000000000000000008080000534d544a ,
        0x000000001000f80748005000200055006e006900760065007200730061006c00 ,
        0x20005000720069006e00740069006e0067002000500043004c00200036000000 ,
        0x496e70757442696e00464f524d534f5552434500524553444c4c00556e697265 ,
        0x73444c4c004850446f635549535549005472756500455350524954537570706f ,
        0x72746564005472756500466173745265730031627070005265736f6c7574696f ,
        0x6e00363030647069005072696e745175616c69747947726f757000505147726f ,
        0x75705f32004850436f6c6f72536d617274004175746f6d61746963004850436f ,
        0x6c6f72536d6172745f436f6c6f724f7074696f6e735f45646765436f6e74726f ,
        0x6c004e6f436d64004850436f6c6f72536d6172745f436f6c6f724f7074696f6e ,
        0x735f48616c66746f6e65004e6f436d64004850436f6c6f72536d6172745f5465 ,
        0x78745f4e65757472616c4772617973004e6f436d64004850436f6c6f72536d61 ,
        0x72745f546578745f48616c66746f6e65004e6f436d64004850436f6c6f72536d ,
        0x6172745f546578745f524742436f6c6f72004e6f436d64004850436f6c6f7253 ,
        0x6d6172745f47726170686963735f4e65757472616c4772617973004e6f436d64 ,
        0x004850436f6c6f72536d6172745f47726170686963735f48616c66746f6e6500 ,
        0x4e6f436d64004850436f6c6f72536d6172745f47726170686963735f52474243 ,
        0x6f6c6f72004e6f436d64004850436f6c6f72536d6172745f50686f746f5f4e65 ,
        0x757472616c4772617973004e6f436d64004850436f6c6f72536d6172745f5068 ,
        0x6f746f5f48616c66746f6e65004e6f436d64004850436f6c6f72536d6172745f ,
        0x50686f746f5f524742436f6c6f72004e6f436d64004f7269656e746174696f6e ,
        0x00504f5254524149540048504f7269656e74526f746174653138300046616c73 ,
        0x65004475706c6578004e4f4e450048505072696e744f6e426f74685369646573 ,
        0x4d616e75616c6c790046616c736500506170657253697a65004134004850436f ,
        0x6e73756d6572437573746f6d50617065720054727565004d6564696154797065 ,
        0x004155544f00436f6c6c617465004f4e0048504e557365446966664669727374 ,
        0x5061676543686f696365005452554500485050616765457863657074696f6e73 ,
        0x46696c6500485043504531313500485050616765457863657074696f6e73496e ,
        0x746572666163650053686f7750616765457863657074696f6e73004850506167 ,
        0x65457863657074696f6e734c6f77456e6400485050616765457863657074696f ,
        0x6e734c6f77456e6456657200485050616765457863657074696f6e7300436f76 ,
        0x6572496e73657274696f6e0048504f757470757442696e4f7269656e74617469 ,
        0x6f6e0046414345444f574e0050756e6368696e67004e6f6e6500537461706c69 ,
        0x6e67004e6f6e65004850537461706c696e674f70706f7365640046616c736500 ,
        0x45636f6e6f6d6f64650046616c736500546578744173426c61636b0046616c73 ,
        0x6500416c7465726e6174654c6574746572486561640046616c7365004850536d ,
        0x61727448756200496e65745f5349445f3236335f4249445f3531345f4849445f ,
        0x323635004f757470757442696e004175746f004850446f6350726f705265736f ,
        0x757263654461746100687063686c3131352e6361620048504c706953656c6563 ,
        0x74696f6e004e6f6e65004a504547456e61626c65004175746f00485045617379 ,
        0x436f6c6f72004f6e0048504d48444c4c4e616d65004850464945313135004850 ,
        0x5f4449425374697463685f54696e74546573740044697361626c65640048504d ,
        0x65646961547970655472656576696577506f7075700054727565004850436f6c ,
        0x6f724d6f646500434f4c4f525f4d4f444500436f6c6f724d6f64650032346270 ,
        0x7000545441734269746d61707353657474696e670054544d6f64654f75746c69 ,
        0x6e6500485050444c547970650050444c5f50434c36004850504a4c456e636f64 ,
        0x696e6700555446380048504a6f624163636f756e74696e670048504a4f424143 ,
        0x43545f4a4f4241434e545f47524f55504e414d45004850426f726e4f6e446174 ,
        0x65004850424f44004850436f6c6f72506c616e6500485043500048504a6f6242 ,
        0x794a6f624f76657272696465004a424a4f0048504a6f62416363576f50696e00 ,
        0x54727565004850584d4c46696c65557365640068706375313135362e786d6c00 ,
        0x4850536d6172744475706c657853696e676c65506167654a6f62005472756500 ,
        0x48504475706c69636174654a6f624e616d654f76657272696465005357465700 ,
        0x4850456e61626c6552415753706f6f6c696e67005472756500524742436f6c6f ,
        0x72004e6f436d64004a52436f6e73747261696e7473004a5243484446756c6c00 ,
        0x4a524844496e7374616c6c6564004a5248444f6666004a5248444e6f74496e73 ,
        0x74616c6c6564004a5248444f666600485042657374476c6f7373004465666175 ,
        0x6c74005053416c69676e6d656e7446696c65004850434c533131350000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xe81300004955504821000100789ced994f6b134118c69f4d16491031d29bad10 ,
        0x0f7a2c2a116a5b2bdbcda60d5a5db3fe29180fc53652a8159a16f4560f227e85 ,
        0x827ad72f91a31fc0ab78f060f113e8457d669bc866d3643d685393e737bcf3ce ,
        0xbc33b33b6467de7777b23b02143d7ffe342c18524dd9abed918e942da6e5304f ,
        0xffee67b4830292c862e7682103fc8c60c61f491c998c15d3ddf8c17b1a9d67ba ,
        0x87cbf6457bd6beff17ee2ffe2ff4fc85185e4cb4f29be556cc68341a6d3a4ab6 ,
        0xd96fb9a365fb4ad2bde231294543da6a6f8ff7a9e036025c635cbd9e74793190 ,
        0x4c23675f60749ab1a7ed73d413f61ca395634fb234d3efc989434cf45dd8c836 ,
        0xdafd8b15936e98f7f3e3d4a79a9da2e54ca45fcb1e6d8f62def90b994ebb185e ,
        0x46b94e4e267dac0921069afd5c402b8e54b0853ad6b084f5839e9610038fd97b ,
        0x25eeae07d8c4636ce029f228620535dab6b8ef36b9fbc4e073ec0ffb99b30fb3 ,
        0x6616b0ca35b3c13553a7d4b84ef2b8415d0bed2bac39d4a654d70a12421c389f ,
        0x29af4e746fff4e47f6ba47fb17ca9b1eede63f4f733eb21038aeeb05c1b8b7e8 ,
        0x197bfc6ce55f48fcbca5d7f9cb58b49e42ae35471793a8c20fbdf843e64b7844 ,
        0xbf5da2075f0bfd7635d1cb57592b3195792d0fe799cc9880bedf0d2d01d338f5 ,
        0x22bcee3fa3e83bfaca1a6e02eecf0aee84b9185eb2fd9e803824947dc72d56ee ,
        0x168339e796ebf8e5d1a977a517855defd9874f132337a7ae760c58ddf9f8fcec ,
        0x37efe599af97dee69ebcf7fdd979c7abf8fb5c5a08218410420821841022915f ,
        0x856f73ce00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x0800240040000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x444f54345f30303100
    End
    OnTimer ="[Event Procedure]"
    OnResize ="[Event Procedure]"
    AllowDatasheetView =0
    FilterOnLoad =0
    ShowPageMargins =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0104220bdc006c0143ff80070100090000000000640001000f00580202000100 ,
        0x5802020000004100340000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000005802180000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000046500800 ,
        0x4d53414343455353000000000000000000000000000000000000000000000000 ,
        0xff3e03005802aa00ac00aa00ac00010000003100436f7572696572204e657700 ,
        0x0000000000000000000000000000000000000000010001000200000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000009600 ,
        0x4b002c0100800000
    End
    PrtDevNamesW = Begin
        0x040011001b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000046005000520031003100 ,
        0x3a000000
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            TextFontCharSet =204
            FontName ="Tahoma"
        End
        Begin Rectangle
            BackStyle =0
            Width =850
            Height =850
        End
        Begin Line
            Width =1701
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            Width =1701
            Height =1701
        End
        Begin CommandButton
            TextFontCharSet =204
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            TextFontCharSet =204
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            TextFontCharSet =204
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin Subform
            SpecialEffect =2
            Width =1701
            Height =1701
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
        End
        Begin ToggleButton
            TextFontCharSet =204
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin FormHeader
            Height =0
            BackColor =-2147483633
            Name ="ЗаголовокФормы"
            GUID = Begin
                0xdb1e8ea451024945b2fc463bb4854ad8
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
        End
        Begin Section
            CanGrow = NotDefault
            Height =1418
            BackColor =-2147483633
            Name ="ОбластьДанных"
            Tag ="BackColor=Dark"
            GUID = Begin
                0xa38b6c950f9f9d4cbb218badf2ac8f20
            End
            Begin
                Begin Image
                    Visible = NotDefault
                    SizeMode =1
                    Width =1418
                    Height =1418
                    Name ="imgFace"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0xdce527f176a49444aafcaf50949dded9
                    End

                    LayoutCachedLeft =90
                    LayoutCachedTop =75
                    LayoutCachedWidth =1337
                    LayoutCachedHeight =1322
                    TabIndex =2
                End
                Begin Label
                    Visible = NotDefault
                    SpecialEffect =2
                    BackStyle =1
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =223
                    TextAlign =2
                    Left =570
                    Top =1020
                    Width =199
                    Height =170
                    FontSize =5
                    FontWeight =700
                    ForeColor =255
                    Name ="txtDate"
                    Caption ="99"
                    Tag ="FontColor=Red"
                    GUID = Begin
                        0x1098a0323c8dc44690d440ca40ac6748
                    End
                    LayoutCachedLeft =615
                    LayoutCachedTop =1035
                    LayoutCachedWidth =814
                    LayoutCachedHeight =1205
                End
                Begin TextBox
                    Visible = NotDefault
                    FELineBreak = NotDefault
                    OverlapFlags =95
                    BackStyle =0
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="fldCondID"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x7de76d549f7fff4bb7b0c1b9c5fdb388
                    End
                    AsianLineBreak =0

                End
                Begin Label
                    OverlapFlags =223
                    TextAlign =2
                    TextFontFamily =0
                    Left =6
                    Top =642
                    Width =2493
                    Height =262
                    FontSize =11
                    FontWeight =700
                    BackColor =8402176
                    Name ="txtDigDate"
                    Caption ="01.03.2024 г."
                    FontName ="DS-Digital"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0x623beaa7cecf6e4a945e62a92427bc0a
                    End
                    LayoutCachedLeft =30
                    LayoutCachedTop =705
                    LayoutCachedWidth =1395
                    LayoutCachedHeight =1050
                    ForeThemeColorIndex =0
                End
                Begin Label
                    OverlapFlags =223
                    TextAlign =2
                    TextFontFamily =0
                    Left =6
                    Top =6
                    Width =2493
                    Height =598
                    FontSize =26
                    FontWeight =700
                    BackColor =8402176
                    Name ="txtDigTime"
                    Caption ="11:24:28"
                    FontName ="DS-Digital"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0x1714c4c42cb15b409280f7241dae83b6
                    End
                    LayoutCachedLeft =30
                    LayoutCachedTop =240
                    LayoutCachedWidth =1395
                    LayoutCachedHeight =585
                    ForeThemeColorIndex =0
                End
                Begin Image
                    Visible = NotDefault
                    Width =1418
                    Height =1418
                    Name ="imgHour"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0xc4c90186f166014c8bbcc550f639d431
                    End

                    LayoutCachedLeft =90
                    LayoutCachedTop =75
                    LayoutCachedWidth =1337
                    LayoutCachedHeight =1322
                    TabIndex =3
                End
                Begin Image
                    Visible = NotDefault
                    Width =1418
                    Height =1418
                    Name ="imgMins"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0xdbb22f76e194b14bae7aa9c3038e0d27
                    End

                    LayoutCachedLeft =90
                    LayoutCachedTop =75
                    LayoutCachedWidth =1337
                    LayoutCachedHeight =1322
                    TabIndex =4
                End
                Begin Image
                    Visible = NotDefault
                    Width =1418
                    Height =1418
                    Name ="imgSecs"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0xee80b7ffe2cd80458c648842d4d5c30c
                    End

                    LayoutCachedLeft =90
                    LayoutCachedTop =75
                    LayoutCachedWidth =1337
                    LayoutCachedHeight =1322
                    TabIndex =1
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    TextFontFamily =0
                    Left =6
                    Top =941
                    Width =2493
                    Height =262
                    FontSize =11
                    FontWeight =700
                    BackColor =8402176
                    Name ="txtDigDayN"
                    Caption ="пятница"
                    FontName ="DS-Digital"
                    OnClick ="=ClockClick()"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0xbf77ba3231ebc94fa88a79e1db46c4cc
                    End
                    ForeThemeColorIndex =0
                End
            End
        End
        Begin FormFooter
            Height =1134
            BackColor =-2147483633
            Name ="ПримечаниеФормы"
            Tag ="BackColor=Dark"
            GUID = Begin
                0x1727a4a6bd3748458dc1b6cc3580b034
            End
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =457
                    Top =30
                    Width =2036
                    Height =480
                    Name ="txtInfo"
                    Caption =" "
                    Tag ="FontColor=White"
                    GUID = Begin
                        0x5a8ebc9a7d32794dad664fbead02021a
                    End
                    LayoutCachedLeft =510
                    LayoutCachedTop =30
                    LayoutCachedWidth =1425
                    LayoutCachedHeight =510
                    ForeThemeColorIndex =0
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =60
                    Top =570
                    Width =227
                    Height =227
                    Name ="flgSecs"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="-1"
                    GUID = Begin
                        0x2321755b55214740a8225268c2269abd
                    End

                    Begin
                        Begin Label
                            OverlapFlags =95
                            Left =289
                            Top =570
                            Width =1140
                            Height =240
                            Name ="Надпись231"
                            Caption ="Секунды"
                            Tag ="FontColor=White"
                            GUID = Begin
                                0xe02ccec5866e3440a4a9aa6778807a09
                            End
                            ForeThemeColorIndex =0
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =87
                    Left =64
                    Top =810
                    Width =227
                    Height =227
                    TabIndex =1
                    Name ="flgDate"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="-1"
                    GUID = Begin
                        0x4a4dfba26084bf4abe48f3a8589d5ec2
                    End

                    Begin
                        Begin Label
                            OverlapFlags =87
                            Left =289
                            Top =810
                            Width =1140
                            Height =240
                            Name ="Надпись233"
                            Caption ="Поле даты"
                            Tag ="FontColor=White"
                            GUID = Begin
                                0x104a3e9293e05648b79a12d762412a9f
                            End
                            ForeThemeColorIndex =0
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =57
                    Top =57
                    Width =340
                    Height =340
                    TabIndex =2
                    Name ="cmd041"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x43084b7876a95e40a135a591a9f66b29
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Option Base 0
'=========================
Private Const c_strModule As String = "Form_Sample_Clock"
'=========================
' Описание      : Пример часиков
' Версия        : 1.2.0.452885137
' Дата          : 28.12.2023 12:19:44
' Автор         : Кашкин Р.В. (KashRus@gmail.com)
' Примечание    : при PictureData_SetToControl - не очень удачное позиционирование
'               : относительно центра - видно как гуляет секундная стрелка
'               : PictureData_SetToControl использует для поворота FreeImage_Rotate
'               : поэтому второй вариант с использованием функций FreeImage напрямую
'               : для поповорота использует FreeImage_RotateEx
'               : четыре разные Image вместо того чтобы совместить изображения и разместить в одном
'               : чтобы не перерисовывать все каждую секунду, а менять только то что реально изменилось
'=========================
#Const ObjectDataType = 0
' ObjectDataType = 0 - (x86/x64) использует библиотеки FreeImage             https://freeimage.sourceforge.io/download.html
'                для работы проект должен содержать модуль modFreeImage (адаптированный под x64 вариант Visual Basic Wrapper for FreeImage 3 by Carsten Klein (cklein05@users.sourceforge.net))
'                ВНИМАНИЕ!!! MSO 2003 (x86) вылетает на Load Library FreeImage.dll (v.3.18 x86), поэтому для x86 используем  FreeImage.dll (v.3.17 x86)
' ObjectDataType = 1 - (x86)     использует модифицированные классы LaVolpe  http://www.planet-source-code.com/vb/scripts/ShowCode.asp? txtCodeId=67466&lngWId=1
Const Offset = 6
Const MinSize = 32

Private Const cstrClockIcon = "Clock"
Private Const cstrClockFace = "ClockFace"
Private Const cstrClockHour = "ClockHour"
Private Const cstrClockMins = "ClockMins"
Private Const cstrClockSecs = "ClockSecs"
' дополнительный текст на циферблате
Private Const cstrClockOverlayText = "Analog"
Private Const clngClockOverlayColor = appColorDark2
Private Const clngClockOverlayFontSize = 0.04
Private Const clngClockOverlayShiftY = 0.075
Private Const cbolClockOverlayFontItalic = True
Private Const clngClockOverlayFontWeight = 600
Private Const cstrClockOverlayFontName = "Arial"
Private Const clngClockOverlayOpacity = 75
' описание типов для переключателя
Private iMin As Byte, iMax As Byte, iStep As Byte
Dim mMaxValue As Long

Private tHour As Byte, tMins As Byte, tSecs As Byte, tDate As Date
Private mShowSec As Boolean, mShowDay As Boolean
Private mClockType As Byte

Private marrTypeDesc() As String
Private aFace() As Byte, aHour() As Byte, aMins() As Byte, aSecs() As Byte
Private hFace As LongPtr, hHour As LongPtr, hMins As LongPtr, hSecs As LongPtr

'=========================
Private Sub Form_Open(Cancel As Integer)
' подготавливаем форму
    mShowSec = flgSecs: mShowDay = flgDate
    Me.InsideWidth = 2500: Me.InsideHeight = 3630
    ClockType = 1
    ByteArray_ReadFromTable cstrClockFace, aFace
    ByteArray_ReadFromTable cstrClockHour, aHour
    ByteArray_ReadFromTable cstrClockMins, aMins
    ByteArray_ReadFromTable cstrClockSecs, aSecs
    Me.TimerInterval = 500 '0.5 секунды
' инициализация данных статического массива
    iMin = LBound(Samples)
'' форматирование формы
'    Call AccObjectSet(Me)
End Sub
Private Function Samples()
' массив данных для примера
' Элемент массива: [i+0]=Index, [i+1]=Title, [i+2]=Icon, [i+3]=Text
On Error Resume Next
Static arrData(): iMin = LBound(arrData): If Err Then Err.Clear Else Samples = arrData: Exit Function
#If ObjectDataType = 0 Then
    arrData = Array(0, "Цифровые часы", "", "12:00", _
                    1, "Аналоговые часы " & vbCrLf & "с PictureData_SetToControl", cstrClockIcon, "", _
                    2, "Аналоговые часы " & vbCrLf & "с FreeImage_RotateEx", cstrClockIcon, "FI")
#Else
    arrData = Array(0, "Цифровые часы", "", "12:00", _
                    1, "Аналоговые часы " & vbCrLf & "с PictureData_SetToControl", cstrClockIcon, "")
#End If
    iStep = 4: iMin = LBound(arrData): iMax = ((UBound(arrData) - iMin + 1) / iStep) - 1
HandleExit: Samples = arrData
End Function

Private Sub Form_Close()
On Error Resume Next
    Select Case mClockType
    Case iMin + 1: p_ClockClearFI
    Case iMin + 2: p_ClockClearAnalog
    End Select
End Sub
Private Sub Form_Resize()
    On Error GoTo HandleError
' выводим часы (размеры определяются размером формы)
Dim lW As Long: lW = Me.InsideWidth - 2 * Offset
Dim lH As Long: lH = Me.InsideHeight - Me.Section(acFooter).Height - Me.Section(acHeader).Height - 2 * Offset
    If lH < MinSize Or lW < MinSize Then Exit Sub
    Call p_ClockDraw(twLeft:=Offset, twTop:=Offset, twWidth:=lW, twHeight:=lH, RedrawAll:=True)
' ресайзим дополнительные контролы по форме
    With txtInfo: .Left = cmd041.Left + cmd041.Width + 10 * Offset: .Width = lW - .Left: End With
HandleExit:  Exit Sub
HandleError: Err.Clear: Resume HandleExit
End Sub
Private Sub Form_Timer(): Call p_ClockDraw: End Sub
Private Sub cmd041_Click(): ClockType = ClockType + 1: End Sub ' переключатель часов
Private Sub flgSecs_AfterUpdate(): mShowSec = flgSecs: End Sub ': Call p_ClockDraw
Private Sub flgDate_AfterUpdate(): mShowDay = flgDate: End Sub ': Call p_ClockDraw
'=================================

Property Let ClockType(mValue As Byte)
    On Error GoTo HandleError
    If mValue > iMax Then mValue = iMin
    'flgDate.Enabled = mValue
    Select Case mValue
    Case iMin:
' цифровые часы
        txtDate.Visible = False
        Call p_ClockClearAnalog: Call p_ClockClearFI
    Case iMin + 1:
' аналоговые часы с PictureData_SetToControl
        txtDigDayN.Visible = False
        Call p_ClockClearFI
    ' храним байтовые массивы картинок элементов часов
    ' создаем из них FIBITMAP каждый раз при изменении соотв компоненты
    ' гуляет центр из-за другого механизма поворота - PictureData_SetToControl использует FreeImage_Rotate
#If ObjectDataType = 0 Then
    Case iMin + 2:
' аналоговые часы с FreeImage_RotateEx
        txtDigDayN.Visible = False
        Call p_ClockClearAnalog
        FreeImage_LoadLibrary ' Load FreeImage Library to memory
    ' храним указатели на уже готовые FIBITMAP картинок элементов часов
        hFace = FreeImage_LoadFromMemoryEx(aFace, FILO_PNG_DEFAULT) ': Call FreeImage_PreMultiplyWithAlpha(hFace)
        hHour = FreeImage_LoadFromMemoryEx(aHour, FILO_PNG_DEFAULT) ': Call FreeImage_PreMultiplyWithAlpha(hHour)
        hMins = FreeImage_LoadFromMemoryEx(aMins, FILO_PNG_DEFAULT) ': Call FreeImage_PreMultiplyWithAlpha(hMins)
        hSecs = FreeImage_LoadFromMemoryEx(aSecs, FILO_PNG_DEFAULT) ': Call FreeImage_PreMultiplyWithAlpha(hSecs)
#End If
    Case Else: Err.Raise vbObjectError + 512
    End Select
' меняем комментарий к текущим часам и иконку
Dim sText As String: sText = Trim(Samples(mValue * iStep + 1))

' если хотим видеть иконку следующего типа (на который переключится при нажатии)
Dim iNext As Long: iNext = mValue + 1: If iNext > iMax Then iNext = iMin
Dim sIcon As String: sIcon = Trim(Samples(iNext * iStep + 2))
Dim sOlay As String: sOlay = Trim(Samples(iNext * iStep + 3))

Dim iSgn As Integer: If Len(sIcon) = 0 Then iSgn = -1 Else iSgn = 1
        PictureData_SetToControl cmd041, sIcon, PictSizeMode:=apObjSizeZoom, _
            TextString:=sOlay, TextPlacement:=ePlaceToRightBottom, TextLeft:=iSgn * 2, TextTop:=iSgn * 1, _
            FontSize:=0.3, FontColor:=vbMagenta, FontWeight:=600 ', FontName:="Arial Narrow"
        txtInfo.Caption = sText
' меняем значение переменной класса
    mClockType = mValue
' выводим часы (размеры определяются размером формы)
Dim lW As Long: lW = Me.InsideWidth - 2 * Offset
Dim lH As Long: lH = Me.InsideHeight - Me.Section(acFooter).Height - Me.Section(acHeader).Height - 2 * Offset
'    If lH < MinSize Or lW < MinSize Then Exit Property
    Call p_ClockDraw(twLeft:=Offset, twTop:=Offset, twWidth:=lW, twHeight:=lH, RedrawAll:=True)
HandleExit:  Exit Property
HandleError: Err.Clear: Resume HandleExit
End Property
Property Get ClockType() As Byte: ClockType = mClockType: End Property
Private Function ClockClick()
Dim strTitle As String:     strTitle = "Вы нажали на часы!)"
Dim strMessage As String:   strMessage = "Текущее время: " & Format$(Now(), "hh:mm:ss")
    MsgBox strMessage, vbOKOnly Or vbInformation, strTitle
End Function
Private Function p_ClockDraw( _
    Optional DateTime, _
    Optional twLeft, Optional twTop, _
    Optional twWidth, Optional twHeight, _
    Optional RedrawAll As Boolean = False)
' транслирует параметры в ф-цию соотв типу часов
On Error GoTo HandleError
' выводим часы указанного типа заданных размеров в заданную позицию
    Select Case mClockType
    Case iMin:      p_ClockDrawDigital DateTime, twLeft, twTop, twWidth, twHeight, RedrawAll ' цифровые часы
    Case iMin + 1:  p_ClockDrawAnalog DateTime, twLeft, twTop, twWidth, twHeight, RedrawAll ' аналоговые часы с PictureData_SetToControl
#If ObjectDataType = 0 Then
    Case iMin + 2:  p_ClockDrawFI DateTime, twLeft, twTop, twWidth, twHeight, RedrawAll   ' аналоговые часы с FreeImage_RotateEx
#End If
    Case Else:      Err.Raise vbObjectError + 512
    End Select
' вывод контролов
Dim bAnalog As Boolean: bAnalog = CBool(mClockType)
    txtDigDate.Visible = Not bAnalog: txtDigTime.Visible = Not bAnalog: txtDigDayN.Visible = mShowDay And Not bAnalog
    imgFace.Visible = bAnalog: imgHour.Visible = bAnalog: imgMins.Visible = bAnalog
    imgSecs.Visible = mShowSec And bAnalog: txtDate.Visible = mShowDay And bAnalog
HandleExit:  Exit Function
HandleError: Err.Clear: Resume HandleExit
End Function
Private Function p_ClockDrawAnalog(Optional DateTime, _
    Optional twLeft, Optional twTop, _
    Optional twWidth, Optional twHeight, _
    Optional RedrawAll = False)
' вывод аналоговых часов с PictureData_SetToControl
Dim Result As Boolean: Result = False
On Error Resume Next
' пропорции часов
'Const csTemp = "ddd,dd" ' шаблон данных поля даты (для "dd" kDW=4/40, для "ddd dd" kDW=8/40
'Const kDW = 12 / 64     ' ширина поля даты от размера часов
Const csTemp = "dd"     ' шаблон данных поля даты (для "dd" kDW=4/40, для "ddd dd" kDW=8/40
Const kDW = 7 / 64      ' ширина поля даты от размера часов
Const kDH = 5 / 64      ' высота поля даты от размера часов
Const kDT = 43 / 64     ' положение по вертикали поля даты от размера часов
Const kDF = 1 / 25      ' размер шрифта (pt) поля даты от высоты поля (tw)
    If Not IsMissing(DateTime) Then DateTime = CDate(DateTime) Else DateTime = Now
' получаем размеры часов
    If IsMissing(twLeft) Then twLeft = imgFace.Left
    If IsMissing(twTop) Then twTop = imgFace.Top
    If IsMissing(twWidth) Then twWidth = imgFace.Width
    If IsMissing(twHeight) Then twHeight = imgFace.Height
'    If twLeft + twWidth > Me.Width Then Stop: Me.Width = twLeft + twWidth
'    If twTop + twHeight > Me.Section(acDetail).Height Then Stop: Me.Section(acDetail).Height = twTop + twHeight
' часы квадратные
    ' в качестве ширины/высоты изображения выбираем минимальный из заданных размеров
Dim twSize As Long: twSize = fMin(twWidth, twHeight)
On Error Resume Next
' устанавливаем размеры контролов
    With imgFace: .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    With imgHour:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    With imgMins:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    If mShowSec Then With imgSecs:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    If mShowDay Then With txtDate:  .Width = kDW * twSize: .Height = kDH * twSize: .Left = twLeft + twSize \ 2 - .Width \ 2: .Top = twTop + kDT * twSize - .Height \ 2: .FontSize = kDF * .Height: .Visible = True: End With
    Err.Clear
On Error GoTo HandleExit
' выводим изображения в контролы при помощи PictureData_SetToControl
    ' циферблат
    If RedrawAll Then
        PictureData_SetToControl imgFace, aFace, _
            Alignment:=eAlignLeftTop, PictSizeMode:=apObjSizeZoom, _
            TextString:=cstrClockOverlayText, TextPlacement:=ePlaceCenter, TextTop:=clngClockOverlayShiftY, TextOpacity:=clngClockOverlayOpacity, _
            FontSize:=clngClockOverlayFontSize, FontColor:=clngClockOverlayColor, FontItalic:=cbolClockOverlayFontItalic, FontWeight:=clngClockOverlayFontWeight, FontName:=cstrClockOverlayFontName
    End If
    ' часовая и минутная стрелки
    If Minute(DateTime) <> tMins Or RedrawAll Then
        tHour = Hour(DateTime): tMins = Minute(DateTime)
        PictureData_SetToControl imgHour, aHour, PictAngle:=-(tHour Mod 12 + tMins / 60) * 30, PictSizeMode:=apObjSizeZoom   '360/12
        PictureData_SetToControl imgMins, aMins, PictAngle:=-(tMins * 6), PictSizeMode:=apObjSizeZoom     '360/60
    End If
    ' секундная стрелка
    If mShowSec Then
    If Second(DateTime) <> tSecs Or RedrawAll Then
        tSecs = Second(DateTime)
        PictureData_SetToControl imgSecs, aSecs, PictAngle:=-(tSecs * 6), PictSizeMode:=apObjSizeZoom     '360/60
    End If
    End If
    'imgSecs.Visible = mShowSec
    ' поле дня
    With txtDate
    If mShowDay Then
    If Fix(DateTime) <> tDate Or RedrawAll Then
        tDate = Fix(DateTime) ' отбрасываем время (дробную часть)
        Dim sTemp As String: sTemp = Format$(DateTime, csTemp)
            If .Caption <> sTemp Then .Caption = sTemp
    End If
    End If
    '    .Visible = mShowDay
    End With
    
    Result = True
HandleExit:  p_ClockDrawAnalog = Result: Exit Function
HandleError: Result = False: Err.Clear: Resume HandleExit
End Function
#If ObjectDataType = 0 Then
Private Function p_ClockDrawFI(Optional DateTime, _
    Optional twLeft, Optional twTop, _
    Optional twWidth, Optional twHeight, _
    Optional RedrawAll = False)
' вывод аналоговых часов с FreeImage_RotateEx
Dim Result As Boolean: Result = False
On Error Resume Next
' пропорции часов
'Const csTemp = "ddd,dd" ' шаблон данных поля даты (для "dd" kDW=4/40, для "ddd dd" kDW=8/40
'Const kDW = 12 / 64     ' ширина поля даты от размера часов
Const csTemp = "dd"     ' шаблон данных поля даты (для "dd" kDW=4/40, для "ddd dd" kDW=8/40
Const kDW = 7 / 64      ' ширина поля даты от размера часов
Const kDH = 5 / 64      ' высота поля даты от размера часов
Const kDT = 43 / 64     ' положение по вертикали поля даты от размера часов
Const kDF = 1 / 25      ' размер шрифта (pt) поля даты от высоты поля (tw)
    If Not IsMissing(DateTime) Then DateTime = CDate(DateTime) Else DateTime = Now
' получаем размеры часов
    If IsMissing(twLeft) Then twLeft = imgFace.Left
    If IsMissing(twTop) Then twTop = imgFace.Top
    If IsMissing(twWidth) Then twWidth = imgFace.Width
    If IsMissing(twHeight) Then twHeight = imgFace.Height
'    If twLeft + twWidth > Me.Width Then Stop: Me.Width = twLeft + twWidth
'    If twTop + twHeight > Me.Section(acDetail).Height Then Stop: Me.Section(acDetail).Height = twTop + twHeight
' часы квадратные
    ' в качестве ширины/высоты изображения выбираем минимальный из заданных размеров
Dim twSize As Long: twSize = fMin(twWidth, twHeight)
On Error Resume Next
' устанавливаем размеры контролов
    With imgFace: .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    With imgHour:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    With imgMins:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    If mShowSec Then With imgSecs:  .Width = twSize: .Height = twSize: .Left = twLeft: .Top = twTop: .Visible = True: End With
    If mShowDay Then With txtDate:  .Width = kDW * twSize: .Height = kDH * twSize: .Left = twLeft + twSize \ 2 - .Width \ 2: .Top = twTop + kDT * twSize - .Height \ 2: .FontSize = kDF * .Height: .Visible = True: End With
    Err.Clear
On Error GoTo HandleExit
' выводим изображения в контролы при помощи FreeImage_RescaleEx/FreeImage_RotateEx
    ' циферблат
    If RedrawAll Then
        p_SetPicture2Image hFace, imgFace, _
            TextString:=cstrClockOverlayText & " (FI)", TextPlacement:=ePlaceCenter, TextTop:=clngClockOverlayShiftY, TextOpacity:=clngClockOverlayOpacity, _
            FontSize:=clngClockOverlayFontSize, FontColor:=clngClockOverlayColor, FontItalic:=cbolClockOverlayFontItalic, FontWeight:=clngClockOverlayFontWeight, FontName:=cstrClockOverlayFontName
    End If
    ' часовая и минутная стрелки
    If Minute(DateTime) <> tMins Or RedrawAll Then
        tHour = Hour(DateTime): tMins = Minute(DateTime)
        p_SetPicture2Image hHour, imgHour, Angle:=-(tHour Mod 12 + tMins / 60) * 30
        p_SetPicture2Image hMins, imgMins, Angle:=-(tMins * 6)
    End If
    ' секундная стрелка
    If mShowSec Then
    If Second(DateTime) <> tSecs Or RedrawAll Then
        tSecs = Second(DateTime)
        p_SetPicture2Image hSecs, imgSecs, Angle:=-(tSecs * 6) '360/60
    End If
    End If
    'imgSecs.Visible = mShowSec
    ' поле дня
    With txtDate
    If mShowDay Then
    If Fix(DateTime) <> tDate Or RedrawAll Then
        tDate = Fix(DateTime) ' отбрасываем время (дробную часть)
        Dim sTemp As String: sTemp = Format$(DateTime, csTemp)
            If .Caption <> sTemp Then .Caption = sTemp
    End If
    End If
    '    .Visible = mShowDay
    End With
    
    Result = True
HandleExit:  p_ClockDrawFI = Result: Exit Function
HandleError: Result = False: Err.Clear: Resume HandleExit
End Function
#End If

Private Function p_ClockDrawDigital(Optional DateTime, _
    Optional twLeft, Optional twTop, _
    Optional twWidth, Optional twHeight, _
    Optional RedrawAll = False)
' вывод цифровых часов
Dim Result As Boolean: Result = False
On Error Resume Next
' пропорции часов
Const kHW = 12 / 25 ' высота часов от ширины часов (twHeight/twWidth)
Const kHT = 32 / 64 ' высота поля времени от высоты часов
Const kHD = 14 / 64 ' высота поля дня/даты от высоты часов
Const kHG = 2 / 64  ' расстояние между полями от высоты часов
Const kHF = 1 / 23  ' размер шрифта (pt) от высоты поля (tw)
    If Not IsMissing(DateTime) Then DateTime = CDate(DateTime) Else DateTime = Now
' получаем размеры часов
    If IsMissing(twLeft) Then twLeft = txtDigTime.Left
    If IsMissing(twTop) Then twTop = txtDigTime.Top
    If IsMissing(twWidth) Then twWidth = txtDigTime.Width
'' высоту часов определяем по нижнему краю нижнего элемента часов
'    If IsMissing(twHeight) Then twHeight = (txtDigDate.Top + txtDigDate.Height) - twTop
' высоту часов определяем из ширины через коэффициент kHW
    If IsMissing(twHeight) Then twHeight = kHW * twWidth
'If twTop + (kHT + 2 * kHD + 2 * kHG) * kHW * twWidth > Me.Section(acDetail).Height Then Stop
'    If twLeft + twWidth > Me.Width Then Stop: Me.Width = twLeft + twWidth
'    If twTop + twHeight > Me.Section(acDetail).Height Then Stop: Me.Section(acDetail).Height = twTop + twHeight
' если заданная ширина часов меньше 25/12 заданной высоты в качестве высоты берем 12/25 ширины
' если заданная высота часов меньше 12/25 заданной ширины в качестве ширины берем 25/12 высоты
    If twWidth < twHeight / kHW Then
        twHeight = kHW * twWidth
    ElseIf twHeight < kHW * twWidth Then
        twWidth = twHeight / kHW
    End If
'If txtDigDayN.Top < txtDigDate.Top Then Stop
' устанавливаем размеры контролов
    With txtDigTime: .Left = twLeft: .Top = twTop: .Width = twWidth: .Height = kHT * twHeight: .FontSize = kHF * kHT * twHeight: End With
    With txtDigDate: .Left = twLeft: .Top = twTop + (kHT + kHG) * twHeight: .Width = twWidth: .Height = kHD * twHeight: .FontSize = kHF * kHD * twHeight: End With
    If mShowDay Then
    With txtDigDayN: .Left = twLeft: .Top = twTop + (kHT + kHD + 2 * kHG) * twHeight: .Width = twWidth: .Height = kHD * twHeight: .FontSize = kHF * kHD * twHeight: End With
    End If
    Err.Clear
On Error GoTo HandleExit
' выводим данные в контролы
Dim sTemp As String
    ' Текущее время
    With txtDigTime:
        sTemp = "hh:nn": If mShowSec Then sTemp = sTemp & ":ss"
        sTemp = Format$(DateTime, sTemp)
        If .Caption <> sTemp Or RedrawAll Then .Caption = sTemp
    End With
    ' Текущая дата
    With txtDigDate
        sTemp = "dd.mm.yyyy г.": sTemp = Format$(DateTime, sTemp)
        If .Caption <> sTemp Or RedrawAll Then .Caption = sTemp
    End With
    ' День недели
    With txtDigDayN
        If mShowDay Then
        sTemp = "dddd": sTemp = Format$(DateTime, sTemp)
        If .Caption <> sTemp Or RedrawAll Then .Caption = sTemp
        End If
    '    .Visible = mShowDay
    End With
    Result = True
HandleExit:  p_ClockDrawDigital = Result: Exit Function
HandleError: Result = False: Err.Clear: Resume HandleExit
End Function
Private Sub p_ClockClearAnalog()
    imgFace.Picture = vbNullString: imgFace.Visible = False
    imgHour.Picture = vbNullString: imgHour.Visible = False
    imgMins.Picture = vbNullString: imgMins.Visible = False
    imgSecs.Picture = vbNullString: imgSecs.Visible = False
    txtDate.Visible = False
'    Erase aFace: Erase aHour: Erase aMins: Erase aSecs
End Sub
Private Sub p_ClockClearFI()
    imgFace.Picture = vbNullString: imgFace.Visible = False
    imgHour.Picture = vbNullString: imgHour.Visible = False
    imgMins.Picture = vbNullString: imgMins.Visible = False
    imgSecs.Picture = vbNullString: imgSecs.Visible = False
    txtDate.Visible = False
#If ObjectDataType = 0 Then
    FreeImage_UnloadEx hFace: FreeImage_UnloadEx hHour: FreeImage_UnloadEx hMins: FreeImage_UnloadEx hSecs
    FreeImage_UnLoadLibrary ' Load FreeImage Library to memory
#End If
End Sub
#If ObjectDataType = 0 Then
Private Function p_SetPicture2Image(fiBITMAP As LongPtr, ctl As Access.Image, Optional Angle As Double, _
            Optional TextString As String, Optional TextPlacement, Optional TextTop, Optional TextLeft, Optional TextOpacity, _
            Optional FontName As String, Optional FontSize, Optional FontWeight, Optional FontItalic, Optional FontUnderline, Optional FontStrikeOut, Optional FontColor _
            ) As Long
    If fiBITMAP = 0 Then Exit Function
    If ctl Is Nothing Then Exit Function
Dim Wb As Long, Hb As Long: Wb = ConvTwipsToPixels(ctl.Width, 0):  Hb = ConvTwipsToPixels(ctl.Height, 1)
Dim Wp As Long, Hp As Long: Wp = FreeImage_GetWidth(fiBITMAP): Hp = FreeImage_GetHeight(fiBITMAP)
Dim fiTemp As LongPtr
' rescale picture
Dim k As Double: If Wp > 0 And Hp > 0 Then k = fMin(Wb / Wp, Hb / Hp) Else k = 4.94065645841247E-324
    fiTemp = FreeImage_RescaleEx(fiBITMAP, k, k, False, False, FILTER_BICUBIC, True)
    Wp = FreeImage_GetWidth(fiTemp): Hp = FreeImage_GetHeight(fiTemp)
' rotate picture
Dim dAngle As Double:    dAngle = fMod(Angle, 360) ' нормализуем угол
    If dAngle <> 0 Then fiTemp = FreeImage_RotateEx(fiTemp, dAngle, 0, 0, Wp / 2, Hp / 2, True)
' добавляем текст
    If Len(Trim(TextString)) > 0 Then
Const Gap = 3
Dim Xt As Single, Yt As Single, Wt As Long, Ht As Long
        Wt = Wb: Ht = Hb
        If IsNumeric(TextLeft) Then Xt = TextLeft: If Abs(Xt) < 1 Then Xt = TextLeft * Wb
        If IsNumeric(TextTop) Then Yt = TextTop: If Abs(Yt) < 1 Then Yt = TextTop * Hb
        If IsNumeric(FontSize) Then FontSize = Abs(FontSize): If FontSize < 1 Then FontSize = FontSize * fMin(Wb, Hb)
Dim hFont As LongPtr: hFont = CreateHFont(FontName, FontSize, FontWeight, FontItalic, FontUnderline, FontStrikeOut) ': If hFont=0 then GoTo HandleComposite
Dim lFontColor As Long: If Not IsMissing(FontColor) Then lFontColor = GetColorFromText(FontColor) Else lFontColor = vbBlack
Dim aText() As String: Call TextToArrayByHFont(TextString, hFont, Wt, Ht, , aText)           ' Wt/Ht     - Расчётные размеры реального текста (до поворота)
    Xt = Wp / 2 - Wt / 2 + Xt + Gap: Yt = Hp / 2 - Ht / 2 + Yt + Gap
Dim fiText As LongPtr: fiText = FreeImage_DrawText(aText, hFont, Wt, Ht, TA_CENTER, lFontColor)   ', lBackColor)
' если есть текст рисуем на подложке текст с заданной прозрачностью
If fiText <> 0 Then Call FreeImage_CompositeWithAlpha(fiTemp, fiText, Xt, Yt, Alpha:=(TextOpacity * 255 / 100)): FreeImage_Unload (fiText)
    End If
' set picture to image
    ctl.PictureData = FreeImage_GetPictureDataEMF(fiTemp, True)
    'Call FreeImage_Unload(fiTemp)
End Function
#End If

Private Function fMin(Val1 As Variant, Val2 As Variant) As Variant
    If Val1 < Val2 Then fMin = Val1 Else fMin = Val2
End Function
Private Function fMod(a As Double, b As Double) As Double
' Mod for Double
    fMod = a - Fix(a / b) * b
'http://en.wikipedia.org/wiki/Machine_epsilon
'Unfortunately, this function can only be accurate when `a / b` is outside [-2.22E-16,+2.22E-16]
'Without this correction, FMod(.66, .06) = 5.55111512312578E-17 when it should be 0
    If fMod >= -2 ^ -52 And fMod <= 2 ^ -52 Then fMod = 0  '+/- 2.22E-16
End Function